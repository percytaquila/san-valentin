<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CorazÃ³n con fecha</title>
    <style>
      :root {
        --bg1: #0b1020;
        --bg2: #121a33;
        --red: #ef4a5a;
        --red2: #d63d4c;
        --text: #e9eefc;
        --muted: #b9c3e6;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        font-family: system-ui, "Segoe UI", Roboto, Arial;
        background: radial-gradient(
          1200px 800px at 50% 30%,
          var(--bg2),
          var(--bg1)
        );
        color: var(--text);
        overflow: hidden;
      }
      .hearts-bg {
        position: fixed;
        inset: 0;
        pointer-events: none;
        overflow: hidden;
        z-index: 0;
      }
      .float-heart {
        position: absolute;
        bottom: -60px;
        width: 22px;
        height: 22px;
        opacity: 0.85;
        animation: floatUp linear forwards;
        filter: drop-shadow(0 10px 10px rgba(0, 0, 0, 0.25));
      }
      @keyframes floatUp {
        from {
          transform: translateY(0) scale(var(--s, 1)) rotate(var(--r, 0deg));
          opacity: 0;
        }
        10% {
          opacity: 0.85;
        }
        to {
          transform: translateY(-110vh) scale(var(--s, 1))
            rotate(var(--r, 0deg));
          opacity: 0;
        }
      }
      .wrap {
        position: relative;
        z-index: 2;
        padding: 24px;
        width: min(520px, 100%);
        display: grid;
        place-items: center;
        text-align: center;
      }
      .panel {
        width: 430px;
        max-width: 100%;
        min-height: 520px;
        display: grid;
        place-items: center;
        position: relative;
      }
      .view {
        position: absolute;
        inset: 0;
        display: grid;
        place-items: center;
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
        transition:
          opacity 0.35s ease,
          transform 0.35s ease;
      }
      .view.active {
        opacity: 1;
        pointer-events: auto;
        transform: scale(1);
      }
      .hint {
        margin-top: 10px;
        color: var(--muted);
        user-select: none;
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 0.2px;
        min-height: 1.4em;
      }
      .stage {
        width: 430px;
        height: 420px;
        display: grid;
        place-items: center;
        cursor: pointer;
        user-select: none;
      }
      .lock {
        width: 380px;
        height: 380px;
        filter: drop-shadow(0 18px 16px rgba(0, 0, 0, 0.35));
        transition: transform 0.25s ease;
      }
      .stage:hover .lock {
        transform: scale(1.02);
      }

      /* ---- Fecha ---- */
      .date-card {
        width: min(360px, 100%);
        background: rgba(255, 255, 255, 0.92);
        color: #1f2937;
        border-radius: 22px;
        padding: 18px 18px 16px;
        box-shadow: 0 24px 70px rgba(0, 0, 0, 0.45);
        border: 1px solid rgba(255, 255, 255, 0.45);
      }
      .date-head {
        text-align: center;
        margin-bottom: 12px;
      }
      .date-head h3 {
        margin: 0;
        font-size: 24px;
        font-weight: 800;
        color: #b91c1c;
      }
      .mini-heart {
        width: 26px;
        height: 26px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 6px;
      }
      .date-display {
        background: rgba(239, 74, 90, 0.1);
        border: 1px solid rgba(239, 74, 90, 0.22);
        border-radius: 14px;
        padding: 12px 14px;
        text-align: center;
        font-weight: 900;
        letter-spacing: 2px;
        color: #b91c1c;
        margin: 10px 0 14px;
        font-size: 20px;
      }
      .keypad {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        padding: 4px 2px 2px;
      }
      .kbtn {
        height: 56px;
        border-radius: 999px;
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: rgba(255, 255, 255, 0.85);
        font-size: 20px;
        font-weight: 800;
        color: #b91c1c;
        cursor: pointer;
        transition:
          transform 0.08s ease,
          background 0.2s ease;
      }
      .kbtn:active {
        transform: scale(0.97);
      }
      .kbtn.muted {
        color: rgba(0, 0, 0, 0.45);
        font-size: 14px;
      }
      .kbtn.ok {
        background: var(--red);
        border-color: rgba(0, 0, 0, 0.06);
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 900;
      }
      .kbtn.ok svg {
        width: 22px;
        height: 22px;
      }
      .back {
        margin-top: 10px;
        width: 100%;
        height: 44px;
        border-radius: 14px;
        border: 1px solid rgba(0, 0, 0, 0.1);
        background: rgba(0, 0, 0, 0.04);
        cursor: pointer;
        font-weight: 800;
        color: rgba(0, 0, 0, 0.55);
      }

      /* ---- Final ---- */
      .final-card {
        width: min(420px, 100%);
        padding: 18px;
        border-radius: 26px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.12);
        box-shadow: 0 24px 70px rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(6px);
      }

      .player {
        width: 100%;
        margin: 6px 0 14px;
        padding: 12px 12px 10px;
        border-radius: 18px;
        background: rgba(0, 0, 0, 0.22);
        border: 1px solid rgba(255, 255, 255, 0.14);
        backdrop-filter: blur(6px);
      }

      .player-top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      .player-title {
        font-weight: 900;
        color: rgba(233, 238, 252, 0.98);
        font-size: 14px;
        text-align: left;
      }

      .playbtn {
        width: 44px;
        height: 44px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        background: rgba(239, 74, 90, 0.92);
        color: #fff;
        font-weight: 900;
        cursor: pointer;
        transition: transform 0.08s ease;
      }
      .playbtn:active {
        transform: scale(0.97);
      }

      .player-meta {
        margin-top: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        font-size: 12px;
        color: rgba(233, 238, 252, 0.9);
        font-weight: 700;
      }

      .seek {
        width: 100%;
        margin-top: 8px;
      }

      .teamo {
        font-size: 58px;
        line-height: 1;
        margin: 6px 0 10px;
        font-weight: 900;
        letter-spacing: 0.5px;
        color: var(--red);
        text-shadow: 0 10px 22px rgba(0, 0, 0, 0.35);
      }
      .valen {
        margin: 0 0 14px;
        font-size: 18px;
        color: rgba(233, 238, 252, 0.95);
        font-weight: 700;
      }
      .bouquet {
        width: min(360px, 100%);
        height: auto;
        filter: drop-shadow(0 18px 18px rgba(0, 0, 0, 0.35));
        margin: 6px auto 0;
        display: block;
        animation: sway 2.6s ease-in-out infinite;
        transform-origin: 50% 90%;
      }
      @keyframes sway {
        0%,
        100% {
          transform: rotate(-1deg) translateY(0);
        }
        50% {
          transform: rotate(1deg) translateY(-3px);
        }
      }
      .spark {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 10px;
        opacity: 0.85;
      }
      .spark svg {
        width: 16px;
        height: 16px;
      }
    </style>
  </head>
  <body>
    <div class="hearts-bg" id="heartsBg"></div>
    <main class="wrap">
      <div class="panel">
        <!-- Vista 1: CorazÃ³n -->
        <section class="view active" id="viewHeart">
          <div
            class="stage"
            id="stage"
            role="button"
            tabindex="0"
            aria-label="Abrir corazÃ³n"
          >
            <svg class="lock" viewBox="0 0 200 200" aria-hidden="true">
              <path
                d="M70 70 C70 40,130 40,130 70"
                fill="none"
                stroke="rgba(255,255,255,.25)"
                stroke-width="10"
                stroke-linecap="round"
              />
              <path
                d="M100 170 C40 130,25 95,45 75 C62 58,85 62,100 80 C115 62,138 58,155 75 C175 95,160 130,100 170Z"
                fill="url(#hgrad)"
              />
              <defs>
                <linearGradient id="hgrad" x1="0" x2="1" y1="0" y2="1">
                  <stop offset="0" stop-color="#ef4a5a" />
                  <stop offset="1" stop-color="#d63d4c" />
                </linearGradient>
              </defs>
              <g transform="translate(100 110)">
                <circle r="16" fill="#111827" />
                <rect
                  x="-7"
                  y="12"
                  width="14"
                  height="18"
                  rx="4"
                  fill="#111827"
                />
              </g>
            </svg>
          </div>
        </section>

        <!-- Vista 2: Fecha -->
        <section class="view" id="viewDate">
          <div class="date-card">
            <div class="date-head">
              <div class="mini-heart">
                <svg viewBox="0 0 24 24" width="26" height="26">
                  <path
                    fill="#ef4a5a"
                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.44C11.53 5.01 13.2 4 14.94 4 17.44 4 19.44 6 19.44 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                  />
                </svg>
              </div>
              <h3>Nuestro Aniversario</h3>
            </div>
            <div class="date-display" id="dateDisplay">DD / MM / AAAA</div>
            <div class="keypad" id="keypad">
              <button class="kbtn" data-key="1">1</button>
              <button class="kbtn" data-key="2">2</button>
              <button class="kbtn" data-key="3">3</button>
              <button class="kbtn" data-key="4">4</button>
              <button class="kbtn" data-key="5">5</button>
              <button class="kbtn" data-key="6">6</button>
              <button class="kbtn" data-key="7">7</button>
              <button class="kbtn" data-key="8">8</button>
              <button class="kbtn" data-key="9">9</button>
              <button class="kbtn muted" data-action="back">Borrar</button>
              <button class="kbtn" data-key="0">0</button>
              <button class="kbtn ok" data-action="ok">
                <svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.44C11.53 5.01 13.2 4 14.94 4 17.44 4 19.44 6 19.44 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                  />
                </svg>
              </button>
            </div>
            <button class="back" id="backBtn">Volver</button>
          </div>
        </section>

        <!-- Vista 3: Final con ramo estilo flat colorido -->
        <section class="view" id="viewFinal">
          <div class="final-card">
            <!-- Reproductor -->
            <div class="player" id="player">
              <div class="player-top">
                <div class="player-title">ðŸŽµ Te dedico esta canciÃ³n</div>

                <button
                  class="playbtn"
                  id="playBtn"
                  aria-label="Reproducir / Pausar"
                >
                  â–¶
                </button>
              </div>

              <div class="player-meta">
                <span id="songName">La Constante - EB</span>
                <span id="timeLabel">0:00 / 0:00</span>
              </div>

              <input
                class="seek"
                id="seek"
                type="range"
                min="0"
                max="100"
                value="0"
                step="0.1"
                aria-label="Barra de progreso"
              />

              <audio id="loveAudio" preload="auto">
                <source src="./La constante - EB.mp3" type="audio/mpeg" />
              </audio>
            </div>

            <div class="teamo">Te amo</div>
            <p class="valen">Â¡Feliz dÃ­a de San ValentÃ­n mi amor! ðŸ’–</p>

            <svg
              class="bouquet"
              viewBox="0 0 340 400"
              xmlns="http://www.w3.org/2000/svg"
            >
              <defs>
                <!-- Sombra suave para flores -->
                <filter id="fs" x="-15%" y="-15%" width="130%" height="130%">
                  <feDropShadow
                    dx="0"
                    dy="3"
                    stdDeviation="3"
                    flood-color="rgba(0,0,0,0.22)"
                  />
                </filter>
                <!-- Papel kraft -->
                <linearGradient id="kraft" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="#c8855a" />
                  <stop offset="30%" stop-color="#e8a87c" />
                  <stop offset="65%" stop-color="#d4926a" />
                  <stop offset="100%" stop-color="#b87050" />
                </linearGradient>
                <linearGradient id="kraft2" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="#be7d54" />
                  <stop offset="50%" stop-color="#d4926a" />
                  <stop offset="100%" stop-color="#b07048" />
                </linearGradient>
              </defs>

              <!-- ========= HOJAS TEAL (fondo, detrÃ¡s de todo) ========= -->
              <!-- hojas largas traseras -->
              <g fill="#0d5c54" filter="url(#fs)">
                <!-- hoja larga izquierda -->
                <path
                  d="M130 260 C90 240, 60 200, 75 150 C80 130, 95 128, 105 150 C120 180, 128 225, 130 260Z"
                />
                <!-- hoja larga centro-izq -->
                <path
                  d="M150 255 C130 225, 120 185, 140 145 C148 128, 162 132, 160 155 C158 185, 155 225, 150 255Z"
                />
                <!-- hoja larga centro -->
                <path
                  d="M170 252 C168 220, 170 180, 175 145 C178 128, 190 130, 188 155 C186 185, 178 220, 170 252Z"
                />
                <!-- hoja larga centro-der -->
                <path
                  d="M195 255 C200 225, 205 185, 195 145 C190 128, 175 130, 178 155 C182 185, 190 225, 195 255Z"
                />
                <!-- hoja larga derecha -->
                <path
                  d="M215 258 C220 230, 230 185, 215 148 C208 130, 194 130, 198 150 C206 175, 212 220, 215 258Z"
                />
                <!-- hoja extra derecha -->
                <path
                  d="M235 260 C248 235, 265 195, 250 155 C243 135, 228 138, 232 160 C238 188, 238 228, 235 260Z"
                />
              </g>

              <!-- hojas medianas mÃ¡s claras (segundo plano) -->
              <g fill="#1a7a6e" filter="url(#fs)">
                <path
                  d="M115 258 C80 242, 58 205, 72 168 C79 148, 94 150, 100 170 C110 200, 115 232, 115 258Z"
                />
                <path
                  d="M240 256 C265 238, 278 200, 262 165 C255 147, 240 150, 244 170 C250 198, 246 230, 240 256Z"
                />
                <!-- hojitas pequeÃ±as entre flores -->
                <path
                  d="M158 235 C148 220, 145 200, 155 185 C160 177, 170 178, 168 192 C165 208, 162 224, 158 235Z"
                />
                <path
                  d="M185 232 C195 218, 198 198, 188 183 C183 175, 173 176, 175 190 C178 206, 182 220, 185 232Z"
                />
              </g>

              <!-- ========= ENVOLTORIO KRAFT ========= -->
              <!-- forma principal del cono -->
              <path
                d="M95 258 C95 258, 80 290, 148 375 L192 375 C260 290, 248 258, 248 258Z"
                fill="url(#kraft)"
              />
              <!-- pliegue izquierdo -->
              <path
                d="M95 258 C95 258, 90 290, 130 350 L148 375 C110 300, 105 270, 95 258Z"
                fill="#be7d54"
                opacity="0.55"
              />
              <!-- pliegue derecho -->
              <path
                d="M248 258 C248 258, 250 290, 210 350 L192 375 C228 300, 238 272, 248 258Z"
                fill="#a06040"
                opacity="0.4"
              />
              <!-- lÃ­nea de doblez central sutil -->
              <path
                d="M170 265 L170 370"
                stroke="#c8855a"
                stroke-width="1.5"
                stroke-dasharray="4,6"
                opacity="0.4"
              />
              <!-- borde superior del kraft (curva) -->
              <path
                d="M95 258 C120 248, 148 244, 170 245 C192 244, 220 248, 248 258"
                fill="none"
                stroke="#be7d54"
                stroke-width="2.5"
                opacity="0.6"
              />

              <!-- banda de cuerda/listÃ³n teal en la base -->
              <path
                d="M148 372 C155 378, 185 378, 192 372 C188 366, 152 366, 148 372Z"
                fill="#3bbfb0"
              />
              <ellipse cx="170" cy="370" rx="24" ry="5" fill="#2aa89a" />
              <ellipse
                cx="170"
                cy="370"
                rx="24"
                ry="5"
                fill="none"
                stroke="#1d8c7e"
                stroke-width="1.5"
              />
              <!-- brillo del listÃ³n -->
              <path
                d="M152 369 C160 367, 180 367, 188 369"
                stroke="#5dd5c8"
                stroke-width="2"
                stroke-linecap="round"
                fill="none"
                opacity="0.7"
              />

              <!-- ========= FLORES ========= -->

              <!-- 
                FUNCIÃ“N MARGARITA ROSA (grande, izquierda)
                Centro amarillo, pÃ©talos redondeados magenta/rosa
              -->
              <!-- margarita rosa grande izq-centro -->
              <g transform="translate(128, 188)" filter="url(#fs)">
                <!-- pÃ©talos exteriores -->
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#e8449a"
                  transform="rotate(0)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#f060b0"
                  transform="rotate(30)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#e8449a"
                  transform="rotate(60)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#f060b0"
                  transform="rotate(90)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#e8449a"
                  transform="rotate(120)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#f060b0"
                  transform="rotate(150)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#e8449a"
                  transform="rotate(180)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#f060b0"
                  transform="rotate(210)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#e8449a"
                  transform="rotate(240)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#f060b0"
                  transform="rotate(270)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#e8449a"
                  transform="rotate(300)"
                />
                <ellipse
                  cx="0"
                  cy="-28"
                  rx="11"
                  ry="18"
                  fill="#f060b0"
                  transform="rotate(330)"
                />
                <!-- sombra pÃ©talos -->
                <circle r="18" fill="#d4308a" opacity="0.3" />
                <!-- centro -->
                <circle r="16" fill="#f8d000" />
                <circle r="10" fill="#f0b800" />
                <circle r="6" fill="#e8a400" />
                <!-- puntitos centro -->
                <circle cx="4" cy="-3" r="2" fill="#d09000" opacity="0.7" />
                <circle cx="-3" cy="4" r="2" fill="#d09000" opacity="0.7" />
                <circle cx="-4" cy="-4" r="1.5" fill="#d09000" opacity="0.7" />
              </g>

              <!-- margarita rosa mÃ¡s pequeÃ±a (izquierda) -->
              <g transform="translate(98, 208)" filter="url(#fs)">
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#f060b0"
                  transform="rotate(0)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#e8449a"
                  transform="rotate(36)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#f060b0"
                  transform="rotate(72)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#e8449a"
                  transform="rotate(108)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#f060b0"
                  transform="rotate(144)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#e8449a"
                  transform="rotate(180)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#f060b0"
                  transform="rotate(216)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#e8449a"
                  transform="rotate(252)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#f060b0"
                  transform="rotate(288)"
                />
                <ellipse
                  cx="0"
                  cy="-22"
                  rx="9"
                  ry="14"
                  fill="#e8449a"
                  transform="rotate(324)"
                />
                <circle r="13" fill="#f8d000" />
                <circle r="8" fill="#f0b800" />
                <circle r="5" fill="#e8a400" />
              </g>

              <!-- margarita rosa centro -->
              <g transform="translate(160, 175)" filter="url(#fs)">
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#e8449a"
                  transform="rotate(0)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#f060b0"
                  transform="rotate(30)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#e8449a"
                  transform="rotate(60)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#f060b0"
                  transform="rotate(90)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#e8449a"
                  transform="rotate(120)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#f060b0"
                  transform="rotate(150)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#e8449a"
                  transform="rotate(180)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#f060b0"
                  transform="rotate(210)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#e8449a"
                  transform="rotate(240)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#f060b0"
                  transform="rotate(270)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#e8449a"
                  transform="rotate(300)"
                />
                <ellipse
                  cx="0"
                  cy="-26"
                  rx="10"
                  ry="17"
                  fill="#f060b0"
                  transform="rotate(330)"
                />
                <circle r="15" fill="#f8d000" />
                <circle r="9" fill="#f0b800" />
                <circle r="5" fill="#e8a400" />
              </g>

              <!-- TULIPANES NARANJA-ROJO (fondo izquierda) -->
              <g transform="translate(115, 172)" filter="url(#fs)">
                <!-- pÃ©talo izq -->
                <path
                  d="M0 0 C-18 -10,-28 -30,-20 -55 C-14 -72,-2 -74, 0 -55 C-2 -74, 10 -72, 16 -55 C22 -32, 14 -12, 0 0Z"
                  fill="#e84830"
                />
                <!-- rayitas de textura -->
                <path
                  d="M-6 -15 C-8 -30,-10 -45,-8 -55"
                  stroke="#c83820"
                  stroke-width="2"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.6"
                />
                <path
                  d="M6  -15 C8  -30, 10 -45, 8  -55"
                  stroke="#c83820"
                  stroke-width="2"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.6"
                />
                <path
                  d="M0  -10 C0  -28, 0  -44, 0  -56"
                  stroke="#ff6848"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.5"
                />
              </g>

              <g transform="translate(145, 155)" filter="url(#fs)">
                <path
                  d="M0 0 C-16 -8,-26 -28,-18 -52 C-12 -68,-1 -70, 0 -52 C1 -70, 12 -68, 18 -52 C24 -28, 16 -8, 0 0Z"
                  fill="#e84030"
                />
                <path
                  d="M-5 -12 C-7 -28,-8 -42,-6 -52"
                  stroke="#c83020"
                  stroke-width="2"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.6"
                />
                <path
                  d="M5  -12 C7  -28, 8  -42, 6  -52"
                  stroke="#c83020"
                  stroke-width="2"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.6"
                />
              </g>

              <!-- MARGARITA AMARILLA grande (derecha) -->
              <g transform="translate(226, 182)" filter="url(#fs)">
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f8c800"
                  transform="rotate(0)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f4d400"
                  transform="rotate(30)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f8c800"
                  transform="rotate(60)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f4d400"
                  transform="rotate(90)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f8c800"
                  transform="rotate(120)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f4d400"
                  transform="rotate(150)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f8c800"
                  transform="rotate(180)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f4d400"
                  transform="rotate(210)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f8c800"
                  transform="rotate(240)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f4d400"
                  transform="rotate(270)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f8c800"
                  transform="rotate(300)"
                />
                <ellipse
                  cx="0"
                  cy="-29"
                  rx="12"
                  ry="19"
                  fill="#f4d400"
                  transform="rotate(330)"
                />
                <circle r="17" fill="#e06000" opacity="0.25" />
                <circle r="16" fill="#f8d000" />
                <circle r="10" fill="#f0a800" />
                <circle r="6" fill="#e09000" />
                <circle cx="3" cy="-3" r="2" fill="#c87000" opacity="0.7" />
                <circle cx="-3" cy="3" r="2" fill="#c87000" opacity="0.7" />
              </g>

              <!-- MARGARITA AMARILLA pequeÃ±a (derecha, mÃ¡s abajo) -->
              <g transform="translate(210, 215)" filter="url(#fs)">
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f8d000"
                  transform="rotate(0)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f4c800"
                  transform="rotate(36)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f8d000"
                  transform="rotate(72)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f4c800"
                  transform="rotate(108)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f8d000"
                  transform="rotate(144)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f4c800"
                  transform="rotate(180)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f8d000"
                  transform="rotate(216)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f4c800"
                  transform="rotate(252)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f8d000"
                  transform="rotate(288)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#f4c800"
                  transform="rotate(324)"
                />
                <circle r="14" fill="#f8d000" />
                <circle r="8" fill="#f0a800" />
                <circle r="5" fill="#e09000" />
              </g>

              <!-- FLOR TEAL/CYAN (derecha) -->
              <g transform="translate(258, 200)" filter="url(#fs)">
                <!-- pÃ©talos redondeados teal -->
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#2abfb0"
                  transform="rotate(0)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#1aa89a"
                  transform="rotate(45)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#2abfb0"
                  transform="rotate(90)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#1aa89a"
                  transform="rotate(135)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#2abfb0"
                  transform="rotate(180)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#1aa89a"
                  transform="rotate(225)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#2abfb0"
                  transform="rotate(270)"
                />
                <ellipse
                  cx="0"
                  cy="-24"
                  rx="10"
                  ry="16"
                  fill="#1aa89a"
                  transform="rotate(315)"
                />
                <!-- centro -->
                <circle r="13" fill="#36d4c4" />
                <circle r="8" fill="#20b8a8" />
                <circle r="4" fill="#18a898" />
                <circle cx="2" cy="-2" r="2" fill="#10988a" opacity="0.7" />
              </g>

              <!-- TULIPÃN NARANJA derecha-centro -->
              <g transform="translate(196, 162)" filter="url(#fs)">
                <path
                  d="M0 0 C-15 -8,-24 -26,-17 -50 C-11 -65,-1 -67, 0 -50 C1 -67, 11 -65, 17 -50 C22 -26, 15 -8, 0 0Z"
                  fill="#f05020"
                />
                <path
                  d="M-5 -12 C-6 -26,-7 -40,-5 -50"
                  stroke="#d84010"
                  stroke-width="2"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.6"
                />
                <path
                  d="M5  -12 C6  -26, 7  -40, 5  -50"
                  stroke="#d84010"
                  stroke-width="2"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.6"
                />
                <path
                  d="M0  -8  C0  -25, 0  -40, 0  -51"
                  stroke="#ff7050"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.5"
                />
              </g>

              <!-- TULIPÃN ROJO pequeÃ±o izquierda fondo -->
              <g transform="translate(86, 220)" filter="url(#fs)">
                <path
                  d="M0 0 C-13 -7,-20 -23,-14 -44 C-9 -57,-1 -59, 0 -44 C1 -59, 9 -57, 14 -44 C19 -23, 13 -7, 0 0Z"
                  fill="#e03828"
                />
                <path
                  d="M0 -8 C0 -22, 0 -36, 0 -44"
                  stroke="#ff5840"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.5"
                />
              </g>

              <!-- TULIPÃN NARANJA extra derecha fondo -->
              <g transform="translate(270, 225)" filter="url(#fs)">
                <path
                  d="M0 0 C-13 -7,-20 -23,-14 -44 C-9 -57,-1 -59, 0 -44 C1 -59, 9 -57, 14 -44 C19 -23, 13 -7, 0 0Z"
                  fill="#f06030"
                />
                <path
                  d="M0 -8 C0 -22, 0 -36, 0 -44"
                  stroke="#ff8050"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  fill="none"
                  opacity="0.5"
                />
              </g>

              <!-- BotÃ³n/capullo rosa pequeÃ±o izquierda -->
              <g transform="translate(105, 232)">
                <ellipse cx="0" cy="0" rx="8" ry="11" fill="#e8449a" />
                <path
                  d="M-5 3 C-3 -5, 3 -5, 5 3 C2 7, -2 7, -5 3Z"
                  fill="#f878c0"
                  opacity="0.8"
                />
                <path
                  d="M-7 4 C-12 0,-10 -8,-5 -5"
                  fill="#1a7a6e"
                  opacity="0.9"
                />
                <path
                  d="M7  4 C12  0, 10 -8, 5  -5"
                  fill="#0d5c54"
                  opacity="0.9"
                />
              </g>

              <!-- BotÃ³n/capullo amarillo pequeÃ±o derecha -->
              <g transform="translate(234, 238)">
                <ellipse cx="0" cy="0" rx="8" ry="11" fill="#f8d000" />
                <path
                  d="M-5 3 C-3 -5, 3 -5, 5 3 C2 7, -2 7, -5 3Z"
                  fill="#fff080"
                  opacity="0.8"
                />
                <path
                  d="M-7 4 C-12 0,-10 -8,-5 -5"
                  fill="#1a7a6e"
                  opacity="0.9"
                />
                <path
                  d="M7  4 C12  0, 10 -8, 5  -5"
                  fill="#0d5c54"
                  opacity="0.9"
                />
              </g>

              <!-- ========= DESTELLOS ========= -->
              <circle cx="128" cy="168" r="3.5" fill="white" opacity="0.55" />
              <circle cx="226" cy="165" r="3" fill="white" opacity="0.5" />
              <circle cx="160" cy="158" r="2.5" fill="white" opacity="0.45" />
              <circle cx="258" cy="182" r="3" fill="white" opacity="0.5" />
            </svg>

            <div class="spark" aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path
                  fill="rgba(239,74,90,.95)"
                  d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.44C11.53 5.01 13.2 4 14.94 4 17.44 4 19.44 6 19.44 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                />
              </svg>
              <svg viewBox="0 0 24 24">
                <path
                  fill="rgba(239,74,90,.95)"
                  d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.44C11.53 5.01 13.2 4 14.94 4 17.44 4 19.44 6 19.44 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                />
              </svg>
              <svg viewBox="0 0 24 24">
                <path
                  fill="rgba(239,74,90,.95)"
                  d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.44C11.53 5.01 13.2 4 14.94 4 17.44 4 19.44 6 19.44 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                />
              </svg>
            </div>
          </div>
        </section>
      </div>

      <div class="hint" id="hint">Haz clic para abrir mi corazÃ³n</div>
    </main>

    <script>
      const SECRET_DATE = "28042023";
      const heartsBg = document.getElementById("heartsBg");
      const viewHeart = document.getElementById("viewHeart");
      const viewDate = document.getElementById("viewDate");
      const viewFinal = document.getElementById("viewFinal");
      const stage = document.getElementById("stage");
      const hint = document.getElementById("hint");
      const dateDisplay = document.getElementById("dateDisplay");
      const keypad = document.getElementById("keypad");
      const backBtn = document.getElementById("backBtn");

      let opened = false,
        rawDigits = "";

      function activate(v) {
        [viewHeart, viewDate, viewFinal].forEach((x) =>
          x.classList.remove("active"),
        );
        v.classList.add("active");
      }
      function showDateView() {
        if (opened) return;
        activate(viewDate);
        rawDigits = "";
        renderDate();
        hint.textContent = "";
      }
      function showHeartView() {
        if (opened) return;
        activate(viewHeart);
        hint.textContent = "Haz clic para abrir mi corazÃ³n";
      }
      function showFinalView() {
        opened = true;
        activate(viewFinal);
        hint.textContent = "";
        burstHearts(18);
      }

      function renderDate() {
        const d = (rawDigits.slice(0, 2) + "DD").slice(0, 2);
        const m = (rawDigits.slice(2, 4) + "MM").slice(0, 2);
        const y = (rawDigits.slice(4, 8) + "AAAA").slice(0, 4);
        dateDisplay.textContent = `${d} / ${m} / ${y}`;
      }
      function pushDigit(n) {
        if (rawDigits.length >= 8) return;
        rawDigits += String(n);
        renderDate();
      }
      function backspace() {
        rawDigits = rawDigits.slice(0, -1);
        renderDate();
      }
      function confirmDate() {
        if (rawDigits === SECRET_DATE) {
          showFinalView();
          return;
        }
        document
          .querySelector(".date-card")
          .animate(
            [
              { transform: "translateX(0)" },
              { transform: "translateX(-8px)" },
              { transform: "translateX(8px)" },
              { transform: "translateX(0)" },
            ],
            { duration: 260, iterations: 1 },
          );
      }

      stage.addEventListener("click", showDateView);
      stage.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") showDateView();
      });
      backBtn.addEventListener("click", showHeartView);
      keypad.addEventListener("click", (e) => {
        const btn = e.target.closest("button");
        if (!btn) return;
        if (btn.dataset.key) pushDigit(btn.dataset.key);
        if (btn.dataset.action === "back") backspace();
        if (btn.dataset.action === "ok") confirmDate();
      });
      window.addEventListener("keydown", (e) => {
        if (!viewDate.classList.contains("active")) return;
        if (e.key >= "0" && e.key <= "9") pushDigit(e.key);
        if (e.key === "Backspace") backspace();
        if (e.key === "Enter") confirmDate();
        if (e.key === "Escape") showHeartView();
      });

      function rand(a, b) {
        return Math.random() * (b - a) + a;
      }
      function createHeart() {
        const el = document.createElement("div");
        el.className = "float-heart";
        const sz = rand(16, 30),
          dur = rand(5.5, 10);
        el.style.left = rand(0, 100) + "vw";
        el.style.width = sz + "px";
        el.style.height = sz + "px";
        el.style.animationDuration = dur + "s";
        el.style.setProperty("--s", rand(0.9, 1.2));
        el.style.setProperty("--r", rand(-18, 18) + "deg");
        const a = rand(0.65, 0.95);
        el.innerHTML = `<svg viewBox="0 0 24 24" width="100%" height="100%"><path fill="rgba(239,74,90,${a})" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.44C11.53 5.01 13.2 4 14.94 4 17.44 4 19.44 6 19.44 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>`;
        heartsBg.appendChild(el);
        setTimeout(() => el.remove(), dur * 1000 + 300);
      }
      function startHearts() {
        setInterval(() => {
          createHeart();
          if (Math.random() > 0.6) createHeart();
        }, 420);
      }
      function burstHearts(n) {
        for (let i = 0; i < n; i++) setTimeout(createHeart, rand(0, 300));
      }
      startHearts();

      // -------- Reproductor (vista final) --------
      const audio = document.getElementById("loveAudio");
      const playBtn = document.getElementById("playBtn");
      const seek = document.getElementById("seek");
      const timeLabel = document.getElementById("timeLabel");

      function fmtTime(sec) {
        if (!isFinite(sec)) return "0:00";
        const m = Math.floor(sec / 60);
        const s = Math.floor(sec % 60);
        return `${m}:${String(s).padStart(2, "0")}`;
      }

      function setPlayIcon(isPlaying) {
        playBtn.textContent = isPlaying ? "â¸" : "â–¶";
      }

      playBtn.addEventListener("click", () => {
        if (audio.paused) audio.play();
        else audio.pause();
      });

      audio.addEventListener("play", () => setPlayIcon(true));
      audio.addEventListener("pause", () => setPlayIcon(false));

      audio.addEventListener("loadedmetadata", () => {
        timeLabel.textContent = `0:00 / ${fmtTime(audio.duration)}`;
      });

      audio.addEventListener("timeupdate", () => {
        if (!audio.duration) return;
        const pct = (audio.currentTime / audio.duration) * 100;
        seek.value = pct;
        timeLabel.textContent = `${fmtTime(audio.currentTime)} / ${fmtTime(audio.duration)}`;
      });

      seek.addEventListener("input", () => {
        if (!audio.duration) return;
        audio.currentTime = (seek.value / 100) * audio.duration;
      });

      // cuando se abre la vista final, opcional: auto-play (en mÃ³vil puede bloquearse)
      const _originalShowFinalView = showFinalView;
      showFinalView = function () {
        _originalShowFinalView();
        // intenta reproducir (si el navegador lo permite)
        audio.play().catch(() => {});
      };
    </script>
  </body>
</html>
